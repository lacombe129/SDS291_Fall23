<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SDS291 - In Class R Activity #2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">SDS291</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://docs.google.com/spreadsheets/d/148AKHY_3sfFzWpG17-OkK2TiI5QiCSd9whtTZPhfKt0/edit?usp=sharing" rel="" target="">
 <span class="menu-text">Course Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../homework.html" rel="" target="">
 <span class="menu-text">Homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://docs.google.com/document/d/13MWHuISh_i8Bj4jUWXJlyWMAq0ZbVjXN/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="menu-text">Final Project Guide</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-trouble-shooting-links" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Trouble shooting links</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-trouble-shooting-links">    
        <li>
    <a class="dropdown-item" href="https://smithcollege-sds.github.io/sds100/lab_01_setup.html" rel="" target="">
 <span class="dropdown-text">Downloading R and RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://smithcollege-sds.github.io/sds100/lab_04_wrangling.html" rel="" target="">
 <span class="dropdown-text">Basics of Data Wranging in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://smithcollege-sds.github.io/sds-www/rmarkdown_problems.html" rel="" target="">
 <span class="dropdown-text">Troubleshooting Quarto</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lecture-slides" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Lecture Slides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lecture-slides">    
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1UEmngV8WZov1wvq02FtvjDwalBjIGdyv/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Welcome Slides</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1DmSHbEVhmmIetIwcD3YCX54kqBj_26LS/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Week 2 Slides- Simple Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1NTJm935dGekJlUC_zdj2266xIEbwcv6_/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Week 3 Slides- Regression Conditions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1OibpmC7CCYrGnkdJ1VgHxbRw2bi8QKth/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Week 4 Slides- Transformation, Conditions, and Inference</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1XXCTMaA49E8xQqjs28dF_8HEq-TSS_XM/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Week 5 Slides- Wrapping Up Simple Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1fKX0FjtpH0P7ILIseUFsOW3-nYz30b1w/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Week 6 Slides- Multiple Regression 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1hTZuCJhqWXKieIWyZGdaEWCiUHL7xA7u/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Week 7 Slides- Multiple Regression 2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../sample_code.html" rel="" target="">
 <span class="menu-text">Sample Code and R- Activities</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#make-a-scatter-plot-for-the-relationship-between-num_pages-and-price-with-points-colored-by-type-of-book" id="toc-make-a-scatter-plot-for-the-relationship-between-num_pages-and-price-with-points-colored-by-type-of-book" class="nav-link" data-scroll-target="#make-a-scatter-plot-for-the-relationship-between-num_pages-and-price-with-points-colored-by-type-of-book">1. Make a scatter plot for the relationship between num_pages and price, with points colored by type of book</a></li>
  <li><a href="#visualize-a-parallel-slopes-model." id="toc-visualize-a-parallel-slopes-model." class="nav-link" data-scroll-target="#visualize-a-parallel-slopes-model.">2. Visualize a parallel slopes model.</a></li>
  <li><a href="#visualize-the-same-relationship-but-without-assuming-the-slopes-are-parallel" id="toc-visualize-the-same-relationship-but-without-assuming-the-slopes-are-parallel" class="nav-link" data-scroll-target="#visualize-the-same-relationship-but-without-assuming-the-slopes-are-parallel">3. Visualize the same relationship, but without assuming the slopes are parallel</a></li>
  <li><a href="#estimate-a-parallel-slopes-model.-do-paperbacks-and-kindle-books-cost-the-same-amount" id="toc-estimate-a-parallel-slopes-model.-do-paperbacks-and-kindle-books-cost-the-same-amount" class="nav-link" data-scroll-target="#estimate-a-parallel-slopes-model.-do-paperbacks-and-kindle-books-cost-the-same-amount">4. Estimate a parallel slopes model. Do paperbacks and kindle books cost the same amount?</a></li>
  <li><a href="#estimate-a-model-with-an-interaction-between-type-of-number-of-pages." id="toc-estimate-a-model-with-an-interaction-between-type-of-number-of-pages." class="nav-link" data-scroll-target="#estimate-a-model-with-an-interaction-between-type-of-number-of-pages.">5. Estimate a model with an interaction between type of number of pages.</a></li>
  <li><a href="#calculate-the-r-squared-manually" id="toc-calculate-the-r-squared-manually" class="nav-link" data-scroll-target="#calculate-the-r-squared-manually">6. Calculate the R-Squared Manually</a></li>
  <li><a href="#what-can-we-conclude-about-how-the-length-of-a-book-and-type-kindlevs-paper-back-are-related-to-its-listing-price" id="toc-what-can-we-conclude-about-how-the-length-of-a-book-and-type-kindlevs-paper-back-are-related-to-its-listing-price" class="nav-link" data-scroll-target="#what-can-we-conclude-about-how-the-length-of-a-book-and-type-kindlevs-paper-back-are-related-to-its-listing-price">7. What can we conclude about how the length of a book and type (kindle/vs paper back) are related to its listing price?</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">In Class R Activity #2</h1>
<p class="subtitle lead">Due Sunday, October 22nd 11:59 PM</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Just as in previous assignments, you are expected to complete this activity and submit both your QMD and PDF. Note, <strong>these data are simulated</strong>.</p>
<p>The expectation for this assignment is for full points you <strong>hide all code, warning messages, and error messages</strong>. I only want to see output, figures, headings, tables, and text (no need to format the table for this lab, but we will start doing in the future). I only want the figures/tables I ask for, so do not include any extra graphs of conditions or other pieces of information.</p>
<p>For this in-class R activity we will be estimating whether the type of book (kindle/paperback) and length of a book (number of pages) is related to its price (measured in dollars).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## read in dataset from github</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/lacombe129/SDS291_Fall23/main/labs/book_data.csv.csv"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="make-a-scatter-plot-for-the-relationship-between-num_pages-and-price-with-points-colored-by-type-of-book" class="level2">
<h2 class="anchored" data-anchor-id="make-a-scatter-plot-for-the-relationship-between-num_pages-and-price-with-points-colored-by-type-of-book">1. Make a scatter plot for the relationship between num_pages and price, with points colored by type of book</h2>
<p>The sample code below gives you a model, where <code>color</code> represents the categorical variable. Do not add any lines of best fit yet. Do you notice anything about the relationship? Does it appear linear?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>INDEPENDENT_VAR, <span class="at">y=</span>DEPENDENT_VAR, <span class="at">color=</span>CAT_VAR))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize-a-parallel-slopes-model." class="level2">
<h2 class="anchored" data-anchor-id="visualize-a-parallel-slopes-model.">2. Visualize a parallel slopes model.</h2>
<p>Use the <code>geom_parallel_slopes()</code> command from the <code>moderndive</code> package to produce the same scatter plot as above, with the additional parallel lines of best fit. Do these lines do a good job summarizing the relationship for each group?</p>
</section>
<section id="visualize-the-same-relationship-but-without-assuming-the-slopes-are-parallel" class="level2">
<h2 class="anchored" data-anchor-id="visualize-the-same-relationship-but-without-assuming-the-slopes-are-parallel">3. Visualize the same relationship, but without assuming the slopes are parallel</h2>
<p>Instead of using <code>geom_parallel_slopes()</code>, if we use <code>geom_smooth(method="lm")</code>, we can visualize the slopes for each type of book separately. Does it appear the slopes are parallel? Summarize the relationship (positive, negative, 0) between number of pages and price for each type of book?</p>
</section>
<section id="estimate-a-parallel-slopes-model.-do-paperbacks-and-kindle-books-cost-the-same-amount" class="level2">
<h2 class="anchored" data-anchor-id="estimate-a-parallel-slopes-model.-do-paperbacks-and-kindle-books-cost-the-same-amount">4. Estimate a parallel slopes model. Do paperbacks and kindle books cost the same amount?</h2>
<p>No other interpretation of the model needed outside of interpreting the term for the shift in intercept.</p>
</section>
<section id="estimate-a-model-with-an-interaction-between-type-of-number-of-pages." class="level2">
<h2 class="anchored" data-anchor-id="estimate-a-model-with-an-interaction-between-type-of-number-of-pages.">5. Estimate a model with an interaction between type of number of pages.</h2>
<p>Interpret the slope term and the interaction. Are the results consistent with what we visualized in question 3?</p>
</section>
<section id="calculate-the-r-squared-manually" class="level2">
<h2 class="anchored" data-anchor-id="calculate-the-r-squared-manually">6. Calculate the R-Squared Manually</h2>
<p>Use the command <code>anova(modelname)</code> to generate the anova results from our model used in Question 5. What is the total sum of squared variation in our dependent variable? What is our sum of squared errors? Use these values to calculate the r-squared. Does this match what was reported in the regression table? Interpret this number.</p>
</section>
<section id="what-can-we-conclude-about-how-the-length-of-a-book-and-type-kindlevs-paper-back-are-related-to-its-listing-price" class="level2">
<h2 class="anchored" data-anchor-id="what-can-we-conclude-about-how-the-length-of-a-book-and-type-kindlevs-paper-back-are-related-to-its-listing-price">7. What can we conclude about how the length of a book and type (kindle/vs paper back) are related to its listing price?</h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>