<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Due Friday, October 6th by 11:59 PM">

<title>SDS291 - In Class R Activity #2/HW 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">SDS291</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://docs.google.com/spreadsheets/d/148AKHY_3sfFzWpG17-OkK2TiI5QiCSd9whtTZPhfKt0/edit?usp=sharing" rel="" target="">
 <span class="menu-text">Course Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../homework.html" rel="" target="">
 <span class="menu-text">Homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://docs.google.com/document/d/13MWHuISh_i8Bj4jUWXJlyWMAq0ZbVjXN/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="menu-text">Final Project Guide</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-trouble-shooting-links" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Trouble shooting links</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-trouble-shooting-links">    
        <li>
    <a class="dropdown-item" href="https://smithcollege-sds.github.io/sds100/lab_01_setup.html" rel="" target="">
 <span class="dropdown-text">Downloading R and RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://smithcollege-sds.github.io/sds100/lab_04_wrangling.html" rel="" target="">
 <span class="dropdown-text">Basics of Data Wranging in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://smithcollege-sds.github.io/sds-www/rmarkdown_problems.html" rel="" target="">
 <span class="dropdown-text">Troubleshooting Quarto</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lecture-slides" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Lecture Slides</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lecture-slides">    
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1UEmngV8WZov1wvq02FtvjDwalBjIGdyv/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Welcome Slides</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1DmSHbEVhmmIetIwcD3YCX54kqBj_26LS/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Week 2 Slides- Simple Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1NTJm935dGekJlUC_zdj2266xIEbwcv6_/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Week 3 Slides- Regression Conditions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://docs.google.com/presentation/d/1OibpmC7CCYrGnkdJ1VgHxbRw2bi8QKth/edit?usp=sharing&amp;ouid=105141350110500354644&amp;rtpof=true&amp;sd=true" rel="" target="">
 <span class="dropdown-text">Week 4 Slides- Transformation, Conditions, and Inference</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../sample_code.html" rel="" target="">
 <span class="menu-text">Sample Code and R- Activities</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#load-packages-and-data" id="toc-load-packages-and-data" class="nav-link" data-scroll-target="#load-packages-and-data">Load Packages and Data</a></li>
  </ul></li>
  <li><a href="#condition-checks--pre-estimation" id="toc-condition-checks--pre-estimation" class="nav-link" data-scroll-target="#condition-checks--pre-estimation">Condition Checks- Pre Estimation</a>
  <ul class="collapse">
  <li><a href="#q1--is-the-dependent-variable-is-quantitative" id="toc-q1--is-the-dependent-variable-is-quantitative" class="nav-link" data-scroll-target="#q1--is-the-dependent-variable-is-quantitative">Q1- Is the Dependent Variable is Quantitative</a></li>
  <li><a href="#q2--is-the-relationship-linear" id="toc-q2--is-the-relationship-linear" class="nav-link" data-scroll-target="#q2--is-the-relationship-linear">Q2- Is the relationship linear</a></li>
  <li><a href="#q3--is-the-spread-constant-homoskedasticity" id="toc-q3--is-the-spread-constant-homoskedasticity" class="nav-link" data-scroll-target="#q3--is-the-spread-constant-homoskedasticity">Q3- Is the spread constant (homoskedasticity)</a></li>
  </ul></li>
  <li><a href="#estimate-linear-model" id="toc-estimate-linear-model" class="nav-link" data-scroll-target="#estimate-linear-model">Estimate Linear Model</a>
  <ul class="collapse">
  <li><a href="#q4--estimate-the-linear-model-and-interpert-both-the-slope-and-intercept-terms.-make-sure-to-include-specific-units-and-note-whether-the-coefficients-are-significant." id="toc-q4--estimate-the-linear-model-and-interpert-both-the-slope-and-intercept-terms.-make-sure-to-include-specific-units-and-note-whether-the-coefficients-are-significant." class="nav-link" data-scroll-target="#q4--estimate-the-linear-model-and-interpert-both-the-slope-and-intercept-terms.-make-sure-to-include-specific-units-and-note-whether-the-coefficients-are-significant.">Q4- Estimate the linear model and interpert both the slope and intercept terms. Make sure to include specific units and note whether the coefficients are significant.</a></li>
  </ul></li>
  <li><a href="#post-estimation-condition-check" id="toc-post-estimation-condition-check" class="nav-link" data-scroll-target="#post-estimation-condition-check">Post Estimation Condition Check</a>
  <ul class="collapse">
  <li><a href="#q5-are-the-residuals-normally-distributed" id="toc-q5-are-the-residuals-normally-distributed" class="nav-link" data-scroll-target="#q5-are-the-residuals-normally-distributed">Q5 Are the residuals normally distributed</a></li>
  <li><a href="#q6-is-there-a-relationship-between-our-residuals-and-our-error" id="toc-q6-is-there-a-relationship-between-our-residuals-and-our-error" class="nav-link" data-scroll-target="#q6-is-there-a-relationship-between-our-residuals-and-our-error">Q6 Is there a relationship between our residuals and our error</a></li>
  </ul></li>
  <li><a href="#q7--is-the-variance-in-our-residuals-constant" id="toc-q7--is-the-variance-in-our-residuals-constant" class="nav-link" data-scroll-target="#q7--is-the-variance-in-our-residuals-constant">Q7- Is the variance in our residuals constant?</a></li>
  <li><a href="#transforming-our-data" id="toc-transforming-our-data" class="nav-link" data-scroll-target="#transforming-our-data">Transforming our data</a>
  <ul class="collapse">
  <li><a href="#q8--re-estimate-the-linear-model-with-a-centered-iv" id="toc-q8--re-estimate-the-linear-model-with-a-centered-iv" class="nav-link" data-scroll-target="#q8--re-estimate-the-linear-model-with-a-centered-iv">Q8- Re-estimate the linear model with a centered IV</a></li>
  <li><a href="#q9--interpreting-other-pieces-of-the-regression-table" id="toc-q9--interpreting-other-pieces-of-the-regression-table" class="nav-link" data-scroll-target="#q9--interpreting-other-pieces-of-the-regression-table">Q9- Interpreting other pieces of the regression table</a></li>
  <li><a href="#q10--what-is-the-typical-error-for-this-model" id="toc-q10--what-is-the-typical-error-for-this-model" class="nav-link" data-scroll-target="#q10--what-is-the-typical-error-for-this-model">Q10- What is the typical error for this model?</a></li>
  <li><a href="#q11--determine-whether-there-are-outliers-in-the-data" id="toc-q11--determine-whether-there-are-outliers-in-the-data" class="nav-link" data-scroll-target="#q11--determine-whether-there-are-outliers-in-the-data">Q11- Determine Whether there are outliers in the data</a></li>
  <li><a href="#q12--make-final-conclusions" id="toc-q12--make-final-conclusions" class="nav-link" data-scroll-target="#q12--make-final-conclusions">Q12- Make final Conclusions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">In Class R Activity #2/HW 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Due Friday, October 6th by 11:59 PM </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The purpose of this lab is to practice evaluating the conditions for linear regression. We will be doing both post-and pre-estimation checks in addition to estimating a linear model.</p>
<p>On a side note, we need to get in the habit of hiding warnings and messages while properly formatting our quarto document. Your final submission must include a .QMD and rendered PDF that hides all warnings/messages.</p>
<p><strong>All figures must include at least 1-2 sentences of write up explaining what we should take away from them for full points.</strong></p>
<section id="load-packages-and-data" class="level2">
<h2 class="anchored" data-anchor-id="load-packages-and-data">Load Packages and Data</h2>
<p>We need the following packages loaded: <code>tidyverse</code>, <code>broom</code>, and <code>reader</code>. As a reminder, you only need to install them once, otherwise you just need to load them by typing <code>library(PACKAGENAME)</code> in a chunk of code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are then going to load a dataset on county life expectancy and education rates. The unit of analysis is US County, the DV is life-expectancy (measured in years) and the IV is the percentage of the population with at least a high school degree. We need to include the chunk below to grab the data directly from my github page. We are saving the location to an object (urlfile) and then telling R to read in this web address as a csv file. Our research question is whether there is a relationship between education level and life expectancy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>urlfile <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/lacombe129/SDS291_Fall23/main/inclass_r/life_exp.csv"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">read.csv</span>(urlfile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="condition-checks--pre-estimation" class="level1">
<h1>Condition Checks- Pre Estimation</h1>
<p>It is up to you to determine how you want to check for each condition, but you need to include at least one graph/figure/descriptive statistic table for each question, and include at least 1 sentence telling us how we should interpret that graph. You can use the same figure for multiple conditions, but you must include text noting whether or not the condition is met/violated.</p>
<section id="q1--is-the-dependent-variable-is-quantitative" class="level3">
<h3 class="anchored" data-anchor-id="q1--is-the-dependent-variable-is-quantitative">Q1- Is the Dependent Variable is Quantitative</h3>
</section>
<section id="q2--is-the-relationship-linear" class="level3">
<h3 class="anchored" data-anchor-id="q2--is-the-relationship-linear">Q2- Is the relationship linear</h3>
</section>
<section id="q3--is-the-spread-constant-homoskedasticity" class="level3">
<h3 class="anchored" data-anchor-id="q3--is-the-spread-constant-homoskedasticity">Q3- Is the spread constant (homoskedasticity)</h3>
</section>
</section>
<section id="estimate-linear-model" class="level1">
<h1>Estimate Linear Model</h1>
<section id="q4--estimate-the-linear-model-and-interpert-both-the-slope-and-intercept-terms.-make-sure-to-include-specific-units-and-note-whether-the-coefficients-are-significant." class="level3">
<h3 class="anchored" data-anchor-id="q4--estimate-the-linear-model-and-interpert-both-the-slope-and-intercept-terms.-make-sure-to-include-specific-units-and-note-whether-the-coefficients-are-significant.">Q4- Estimate the linear model and interpert both the slope and intercept terms. Make sure to include specific units and note whether the coefficients are significant.</h3>
</section>
</section>
<section id="post-estimation-condition-check" class="level1">
<h1>Post Estimation Condition Check</h1>
<section id="q5-are-the-residuals-normally-distributed" class="level3">
<h3 class="anchored" data-anchor-id="q5-are-the-residuals-normally-distributed">Q5 Are the residuals normally distributed</h3>
<p>As a reminder, you have two options. Either use the <code>augment()</code> command to extract the residuals, and make a histogram of the residuals. Or us the command <code>plot(MODELNAME, which=2)</code> to produce a QQ plot. Either works</p>
</section>
<section id="q6-is-there-a-relationship-between-our-residuals-and-our-error" class="level3">
<h3 class="anchored" data-anchor-id="q6-is-there-a-relationship-between-our-residuals-and-our-error">Q6 Is there a relationship between our residuals and our error</h3>
<p>As a reminder, you have two options. Either use the <code>augment()</code> command to extract the residuals, and make a scatterplot of the residuals and fitted values. Or us the command <code>plot(MODELNAME, which=1)</code> to produce a QQ plot. Either works.</p>
</section>
</section>
<section id="q7--is-the-variance-in-our-residuals-constant" class="level1">
<h1>Q7- Is the variance in our residuals constant?</h1>
</section>
<section id="transforming-our-data" class="level1">
<h1>Transforming our data</h1>
<p>Right now, the intercept is fairly non-sensical. So, to correct it let’s center the data by subtracting the mean from every observation. I provided you a sample of the code needed to center the data below. Make a scatter plot with a line of best fit (add <code>geom_smooth(method="lm")</code> to your ggplot). What does a value of 0 now indicate for our IV?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">centered_VARNAME=</span>VARNAME<span class="sc">-</span><span class="fu">mean</span>(VARNAME))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="q8--re-estimate-the-linear-model-with-a-centered-iv" class="level3">
<h3 class="anchored" data-anchor-id="q8--re-estimate-the-linear-model-with-a-centered-iv">Q8- Re-estimate the linear model with a centered IV</h3>
<p>Make sure to interpret both the slope and intercept, noting significance for each.</p>
</section>
<section id="q9--interpreting-other-pieces-of-the-regression-table" class="level3">
<h3 class="anchored" data-anchor-id="q9--interpreting-other-pieces-of-the-regression-table">Q9- Interpreting other pieces of the regression table</h3>
<p>What is the t-value for the slope coefficient? What does it mean and why is it relevant for us to test the null hypothesis?</p>
</section>
<section id="q10--what-is-the-typical-error-for-this-model" class="level2">
<h2 class="anchored" data-anchor-id="q10--what-is-the-typical-error-for-this-model">Q10- What is the typical error for this model?</h2>
<p>Be sure to interpret it in the proper units.</p>
</section>
<section id="q11--determine-whether-there-are-outliers-in-the-data" class="level2">
<h2 class="anchored" data-anchor-id="q11--determine-whether-there-are-outliers-in-the-data">Q11- Determine Whether there are outliers in the data</h2>
<p>Visualize the residuals to demonstrate whether there are any outliers.</p>
</section>
<section id="q12--make-final-conclusions" class="level2">
<h2 class="anchored" data-anchor-id="q12--make-final-conclusions">Q12- Make final Conclusions</h2>
<p>After evaluating all of the conditions above, did we meet the condtions to estimate a simple regression? What is our conclusion about the relationship between education and life expectancy?</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>